{"version":3,"sources":["webpack:///webpack/bootstrap efd8184f1dff8c8ab4f3","webpack:///./init.js","webpack:///./ui.js","webpack:///./settings.js","webpack:///./connect.js","webpack:///./data.js","webpack:///./websocket.js","webpack:///./ui_messages.js","webpack:///./templates.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC;;AAED;AACA;AACA,kDAAiD;AACjD;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;AC5DA;AACA;AACA,qCAAoC,0BAA0B,yDAAyD,EAAE,kBAAkB,0BAA0B,EAAE,mCAAmC,8BAA8B,oCAAoC,cAAc,EAAE;AAC5R,eAAc;AACd,2BAA0B,mBAAmB,gCAAgC,GAAG;;AAEhF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACxVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACZA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,iBAAgB;AAChB,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;;AAEA;;;;;;;ACjJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,oCAAmC,SAAS;AAC5C;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;;;;;;;ACrEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;;;;;;;ACpQA;AACA;AACA,2BAA0B,mBAAmB,gCAAgC,GAAG,EAAE;AAClF,qCAAoC,0BAA0B,yDAAyD,EAAE,kBAAkB,0BAA0B,EAAE,mCAAmC,8BAA8B,oCAAoC,cAAc,EAAE;AAC5R,eAAc;;AAEd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAC;;AAED;AACA;AACA;;AAEA;;;;;;;AC5CA;AACA;AACA;AACA,uFAAsF,UAAU,WAAW,6BAA6B;AACxI;AACA;;AAEA","file":"metabook.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap efd8184f1dff8c8ab4f3\n **/","// Generated by CoffeeScript 1.10.0\nvar error_graph, init_graph;\n\n$(document).ready(function() {\n  var global_gui, imports, message, session, uivent;\n  imports = {\n    ui: require(\"./ui\"),\n    connect: require(\"./connect\"),\n    data: require(\"./data\"),\n    messages: require(\"./ui_messages\"),\n    settings: require(\"./settings\")\n  };\n  message = new imports.messages.SessionDisconnectedMessage({\n    el: imports.settings.id.globalmessages\n  });\n  message.show();\n  uivent = new imports.ui.Vent();\n  uivent.register({\n    'ui': imports.ui\n  });\n  global_gui = new imports.ui.GlobalGUI();\n  session = new imports.connect.Session(config.sessions_endpoint);\n  session.connect_metabook(config.file.path);\n  return imports.data.get_xhr(config.file.endpoint + config.file.path).done(function(file_json) {\n    return init_graph(file_json);\n  }).fail(error_graph);\n});\n\ninit_graph = function(json_graph) {\n  var menuview, notebook, paper;\n  notebook = new metabook.models.MetabookModel({}, {\n    json_graph: json_graph\n  });\n  paper = init_jointjs(notebook);\n  notebook.session = new metabook.connect.Session(config.sessions_endpoint, notebook.id);\n  $(\"#id2\").dimmer('hide');\n  $(\"#bottom_sidebar\").sidebar({\n    context: $('#id2')\n  });\n  $(\"#bottom_sidebar\").sidebar('setting', 'transition', 'overlay');\n  $(\"#bottom_sidebar\").sidebar('setting', 'dimPage', false);\n  $(\"#bottom_sidebar\").sidebar('attach events', '#uiMenuToggle');\n  $(\"#bottom_sidebar\").sidebar('setting', 'closable', false);\n  uivent.register({\n    'session': notebook.session,\n    'model': notebook,\n    'graph': paper.model\n  });\n  jointjs_attach_events(paper, paper.model);\n  return menuview = new metabook.views.MenuView({\n    el: $(\"#metabook_top_menu\"),\n    model: notebook\n  });\n};\n\nerror_graph = function(e) {\n  $(\"#id2\").dimmer('hide');\n  return alert(\"Connection error. Check if your backend is running.\");\n};\n\n//# sourceMappingURL=init.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./init.js\n ** module id = 0\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\nvar ContextMenu, ContextMenuView, GlobalGUI, Settings, Vent, bind_context_menus, custom_events, settings,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nSettings = require(\"./settings\");\n\nsettings = {\n  active_menu_class: \"context-menu--active\",\n  selector: \"#context-menu\",\n  context_bindings: {\n    \".element\": \"#context-menu\",\n    \"svg\": \"#context-menu2\"\n  },\n  templates: {\n    node: \"<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:properties\\\"><i class=\\\"fa fa-tasks\\\"></i> Properties <div class=\\\"ui small inverted label\\\">Ctrl+Enter</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"session:run\\\"><i class=\\\"fa fa-play\\\"></i> Run Node <div class=\\\"ui small inverted label\\\">Ctrl+E</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:update\\\"><i class=\\\"fa fa-exchange\\\"></i> Sync to Server <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:expand\\\"><i class=\\\"fa fa-expand\\\"></i> Expand & Edit <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:duplicate\\\"><i class=\\\"fa fa-copy\\\"></i> Duplicate <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:similar\\\"><i class=\\\"fa fa-plus\\\"></i> Select Similar <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:delete\\\"><i class=\\\"fa fa-times\\\"></i> Delete <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\",\n    blank: \"<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:newnode\\\"><i class=\\\"fa fa-eye\\\"></i> New node <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"model:solve\\\"><i class=\\\"fa fa-edit\\\"></i> Run <div class=\\\"ui small inverted label\\\">Ctrl+E</div></a>\\n<a href=\\\"#\\\" class=\\\"item\\\" data-action=\\\"graph:node:delete\\\"><i class=\\\"fa fa-times\\\"></i> Delete <div class=\\\"ui small inverted label\\\">Ctrl+D</div></a>\"\n  }\n};\n\nbind_context_menus = function() {\n  var menu_id, ref, results, selector;\n  ref = settings.context_bindings;\n  results = [];\n  for (selector in ref) {\n    menu_id = ref[selector];\n    results.push(this.context_listener.apply(this, [selector, menu_id]));\n  }\n  return results;\n};\n\ncustom_events = {\n  'add': function(cell) {\n    return cell.$box.on('contextmenu', _.partialRight(function(e, cell) {\n      var menu;\n      e.preventDefault();\n      return menu = new ContextMenuView(cell.model, {\n        cell: cell,\n        event: e,\n        \"class\": settings.active_menu_class,\n        selector: settings.selector,\n        template: settings.templates.node\n      });\n    }, cell));\n  },\n  'blankmenu': function(paper, e) {\n    var menu;\n    e.preventDefault();\n    return menu = new ContextMenuView(paper.model, {\n      event: e,\n      \"class\": settings.active_menu_class,\n      selector: settings.selector,\n      template: settings.templates.blank\n    });\n  }\n};\n\nGlobalGUI = (function(superClass) {\n  extend(GlobalGUI, superClass);\n\n  function GlobalGUI() {\n    return GlobalGUI.__super__.constructor.apply(this, arguments);\n  }\n\n  GlobalGUI.prototype.initialize = function() {\n    this.listenTo(Backbone, 'graph:notready', this.dim);\n    return this.listenTo(Backbone, 'graph:ready', this.undim);\n  };\n\n  GlobalGUI.prototype.dim = function() {\n    return $(\"#id2\").dimmer({\n      closable: false\n    }).dimmer('show');\n  };\n\n  GlobalGUI.prototype.undim = function() {\n    return $(\"#id2\").dimmer('hide');\n  };\n\n  return GlobalGUI;\n\n})(Backbone.View);\n\nContextMenuView = (function(superClass) {\n  extend(ContextMenuView, superClass);\n\n  function ContextMenuView() {\n    this.getPosition = bind(this.getPosition, this);\n    this.position_active_menu = bind(this.position_active_menu, this);\n    this.hide = bind(this.hide, this);\n    return ContextMenuView.__super__.constructor.apply(this, arguments);\n  }\n\n  ContextMenuView.prototype.initialize = function(model, settings) {\n    this.active_menu_class = settings[\"class\"];\n    this.template = settings.template;\n    this.el = $(settings.selector);\n    this.event = settings.event;\n    this.model = model;\n    this.cell = settings.cell;\n    Backbone.View.prototype.initialize.apply(this, arguments);\n    return this.render();\n  };\n\n  ContextMenuView.prototype.render = function() {\n    this.el.html(this.template);\n    this.el.addClass(this.active_menu_class);\n    this.position_active_menu(this.event);\n    document.addEventListener(\"click\", this.hide);\n    $(Settings.id.paper).on('mousewheel', this.hide);\n    window.onresize = this.hide;\n    window.onkeyup = (function(_this) {\n      return function(e) {\n        if (e.keyCode === 27) {\n          return _this.hide();\n        }\n      };\n    })(this);\n    return this.el.on(\"click [data-action]\", (function(_this) {\n      return function(ev) {\n        var custom_event;\n        _this.el.off('click [data-action]');\n        custom_event = ev.target.dataset.action;\n        Vent.vent(custom_event, _this.model, ev);\n        console.log(custom_event + \" element event triggered\");\n        return _this.hide();\n      };\n    })(this));\n  };\n\n  ContextMenuView.prototype.hide = function() {\n    this.el.removeClass(this.active_menu_class);\n    this.remove();\n    return this.unbind();\n  };\n\n  ContextMenuView.prototype.position_active_menu = function(e) {\n    var menuHeight, menuWidth, ref, windowHeight, windowWidth, x, y;\n    ref = this.getPosition(e), x = ref.x, y = ref.y;\n    menuWidth = this.el.offsetWidth + 4;\n    menuHeight = this.el.offsetHeight + 4;\n    windowWidth = window.innerWidth;\n    windowHeight = window.innerHeight;\n    if (windowWidth - x < menuWidth) {\n      this.el.css('left', windowWidth - menuWidth + 'px');\n    } else {\n      this.el.css('left', x + 'px');\n    }\n    if (windowHeight - y < menuHeight) {\n      this.el.css('top', windowHeight - menuHeight + 'px');\n    } else {\n      this.el.css('top', y + 'px');\n    }\n  };\n\n  ContextMenuView.prototype.getPosition = function(e) {\n    var posx, posy;\n    posx = 0;\n    posy = 0;\n    if (e == null) {\n      e = window.event;\n    }\n    if (e.pageX) {\n      posx = e.pageX;\n      posy = e.pageY;\n    } else {\n      posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n      posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n    }\n    return {\n      x: posx,\n      y: posy - 12\n    };\n  };\n\n  return ContextMenuView;\n\n})(Backbone.View);\n\nContextMenu = {\n\n  /*\n  Usage:\n  selector is the element to bind menu to\n  menu_id is the id of menu div that is being bound to selector\n  settings.context_menu = { str selector: str menu_id, ... }\n   */\n  active_menu_class: \"context-menu--active\",\n  active_menu: void 0,\n  init: function(settings) {\n    var context, menu_id, selector;\n    this.active_menu_class = settings.active_menu_class || this.active_menu_class;\n    context = settings.context_menu;\n    this.active_menu = void 0;\n    for (selector in context) {\n      menu_id = context[selector];\n      this.context_listener.apply(this, [selector, menu_id]);\n    }\n    this.clickListener();\n    this.keyupListener();\n    this.resizeListener();\n    this.scrollListener();\n  },\n  context_listener: function(selector, menu_id) {\n    $(selector).on('contextmenu', function(e) {\n      e.preventDefault();\n      if (ContextMenu.active_menu) {\n        ContextMenu.active_menu_off();\n      }\n      ContextMenu.menu_on(menu_id);\n      ContextMenu.position_active_menu(e);\n      return e.stopPropagation();\n    });\n  },\n  active_menu_off: function() {\n    if (ContextMenu.active_menu) {\n      ContextMenu.active_menu.classList.remove(ContextMenu.active_menu_class);\n      ContextMenu.active_menu = void 0;\n    }\n  },\n  menu_on: function(menu_id) {\n    ContextMenu.active_menu = document.querySelector(menu_id);\n    ContextMenu.active_menu.classList.add(ContextMenu.active_menu_class);\n  },\n  position_active_menu: function(e) {\n    var menuHeight, menuWidth, ref, windowHeight, windowWidth, x, y;\n    ref = ContextMenu.getPosition(e), x = ref.x, y = ref.y;\n    menuWidth = ContextMenu.active_menu.offsetWidth + 4;\n    menuHeight = ContextMenu.active_menu.offsetHeight + 4;\n    windowWidth = window.innerWidth;\n    windowHeight = window.innerHeight;\n    if (windowWidth - x < menuWidth) {\n      ContextMenu.active_menu.style.left = windowWidth - menuWidth + 'px';\n    } else {\n      ContextMenu.active_menu.style.left = x + 'px';\n    }\n    if (windowHeight - y < menuHeight) {\n      ContextMenu.active_menu.style.top = windowHeight - menuHeight + 'px';\n    } else {\n      ContextMenu.active_menu.style.top = y + 'px';\n    }\n  },\n  getPosition: function(e) {\n    var posx, posy;\n    posx = 0;\n    posy = 0;\n    if (e == null) {\n      e = window.event;\n    }\n    if (e.pageX) {\n      posx = e.pageX;\n      posy = e.pageY;\n    } else {\n      posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n      posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n    }\n    return {\n      x: posx,\n      y: posy - 12\n    };\n  },\n  clickListener: function() {\n    return document.addEventListener(\"click\", function(e) {\n      ContextMenu.active_menu_off();\n    });\n  },\n  keyupListener: function() {\n    window.onkeyup = function(e) {\n      if (e.keyCode === 27) {\n        ContextMenu.active_menu_off();\n      }\n    };\n  },\n  resizeListener: function() {\n    window.onresize = function(e) {\n      ContextMenu.active_menu_off();\n    };\n  },\n  scrollListener: function() {\n    $('#myholder').on('mousewheel', function(e) {\n      ContextMenu.active_menu_off();\n    });\n  }\n};\n\nVent = (function() {\n  function Vent() {\n    _.extend(this, Backbone.Events);\n  }\n\n  Vent.prototype.register = function(handlers) {\n    var event_handler, eventclass, eventname, handler, results;\n    results = [];\n    for (eventclass in handlers) {\n      handler = handlers[eventclass];\n      results.push((function() {\n        var ref, results1;\n        ref = handler['custom_events'];\n        results1 = [];\n        for (eventname in ref) {\n          event_handler = ref[eventname];\n          results1.push(this.listenTo(Backbone, eventclass + \":\" + eventname, _.bind(event_handler, handler)));\n        }\n        return results1;\n      }).call(this));\n    }\n    return results;\n  };\n\n  Vent.vent = function(custom_event) {\n    var args, primary, secondary, tokens;\n    tokens = custom_event.split(':');\n    primary = tokens.slice(0, 2).join(':');\n    secondary = tokens.slice(2).join(':');\n    args = [].slice.call(arguments, 1);\n    if (secondary !== \"\") {\n      args.unshift(secondary);\n    }\n    args.unshift(primary);\n    return Backbone.trigger.apply(Backbone, args);\n  };\n\n  Vent.passover = function() {\n    var args, event_name, obj;\n    args = [].slice.call(arguments, 2);\n    event_name = arguments[0];\n    obj = arguments[1];\n    return obj.custom_events[event_name].apply(obj, args);\n  };\n\n  return Vent;\n\n})();\n\nmodule.exports = {\n  bind_context_menus: bind_context_menus,\n  custom_events: custom_events,\n  ContextMenuView: ContextMenuView,\n  ContextMenu: ContextMenu,\n  Vent: Vent,\n  GlobalGUI: GlobalGUI\n};\n\n//# sourceMappingURL=ui.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./ui.js\n ** module id = 1\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\nmodule.exports = {\n  id: {\n    messages: \"#messages\",\n    coords: \"#coords\",\n    graph_container: \"#paper_holder\",\n    paper: \"#myholder\",\n    svg: \"#v-2\",\n    globalmessages: \"#globalmessages\"\n  }\n};\n\n//# sourceMappingURL=settings.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./settings.js\n ** module id = 2\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\nvar Message, Session, imports;\n\nimports = {\n  data: require(\"./data\"),\n  websocket: require(\"./websocket\")\n};\n\nSession = (function() {\n  function Session(url) {\n    this.id = joint.util.uuid();\n    this.ws = new imports.websocket(\"ws://\" + url + this.id, null, {\n      debug: true,\n      reconnectInterval: 1000,\n      maxReconnectInterval: 30000,\n      reconnectDecay: 1.5\n    });\n    this.ws.onopen = this.onopen;\n    this.ws.onmessage = this.onmessage;\n    this.ws.onclose = this.onclose;\n  }\n\n  Session.prototype.onopen = function(evt) {\n    return console.log('<connection onopen>');\n  };\n\n  Session.prototype.connect_notebook = function(local_path) {\n    var msg;\n    msg = this.new_message({\n      type: 'connect notebook'\n    });\n    return this.ws.send(msg.serialize());\n  };\n\n  Session.prototype.new_message = function(arg) {\n    var content, type;\n    type = arg.type, content = arg.content;\n    return new Message({\n      session: this.id,\n      msg_type: type,\n      content: content\n    });\n  };\n\n  Session.prototype.run_cell = function(node_model, event) {\n    var cells, ids, links, msg;\n    cells = importsimports.data.get_cells(node_model.graph.metabook);\n    links = importsimports.data.get_links(node_model.graph.metabook);\n    ids = [node_model.id];\n    msg = new Message({\n      session: this.id,\n      msg_type: \"update\",\n      content: {\n        cells: cells,\n        links: links,\n        ids: ids\n      }\n    });\n    return this.ws.send(msg.serialize());\n  };\n\n  Session.prototype.solve_all = function(metabook_model, event) {\n    var cells, ids, links, msg;\n    cells = imports.data.get_cells(metabook_model);\n    links = imports.data.get_links(metabook_model);\n    ids = imports.data.get_ids(cells);\n    msg = new Message({\n      session: this.id,\n      msg_type: \"solve\",\n      content: {\n        cells: cells,\n        links: links,\n        ids: ids\n      }\n    });\n    this.ws.send(msg.serialize());\n    return console.log(\"solve_all: \" + this.id);\n  };\n\n  Session.prototype.onmessage = function(evt) {\n    return console.log(JSON.parse(evt.data));\n  };\n\n  Session.prototype.onclose = function(evt) {\n    console.log(\"<session:closed>\");\n    return Backbone.trigger('session:closed', this);\n  };\n\n  Session.prototype.custom_events = {\n    'run': Session.prototype.run_cell\n  };\n\n  return Session;\n\n})();\n\nMessage = (function() {\n  function Message(arg) {\n    var msg_type, session;\n    session = arg.session, msg_type = arg.msg_type, this.header = arg.header, this.parent_header = arg.parent_header, this.metadata = arg.metadata, this.content = arg.content;\n    if (this.header == null) {\n      this.header = this.defaults.header();\n    }\n    this.header.session = session;\n    this.header.msg_type = msg_type;\n    if (this.metadata == null) {\n      this.metadata = this.defaults.metadata;\n    }\n    if (this.parent_header == null) {\n      this.parent_header = this.defaults.parent_header;\n    }\n    if (this.content == null) {\n      this.content = this.defaults.content;\n    }\n  }\n\n  Message.prototype.defaults = {\n    header: function() {\n      return {\n        msg_id: joint.util.uuid(),\n        username: \"default\",\n        session: \"\",\n        date: \"\",\n        msg_type: \"default\",\n        version: '1'\n      };\n    },\n    metadata: {},\n    parent_header: {},\n    content: {}\n  };\n\n  Message.prototype.serialize = function() {\n    return JSON.stringify(this);\n  };\n\n  return Message;\n\n})();\n\nmodule.exports = {\n  Session: Session,\n  Message: Message\n};\n\n//# sourceMappingURL=connect.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./connect.js\n ** module id = 3\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\nmodule.exports = {\n  get_template: function(success, error) {\n    return $.ajax({\n      url: config.template_endpoint + config.file.path,\n      type: 'GET',\n      success: success,\n      error: error\n    });\n  },\n  get_file: function(success, error) {\n    return $.ajax({\n      url: config.file.endpoint + config.file.path,\n      type: 'GET',\n      success: success,\n      error: error\n    });\n  },\n  get_ajax_data: function(data_uri, success, error) {\n    return $.ajax({\n      url: data_uri,\n      type: 'GET',\n      success: success,\n      error: error\n    });\n  },\n  get_xhr: function(data_uri) {\n    return $.ajax({\n      url: data_uri,\n      type: 'GET'\n    });\n  },\n  is_good_form: function(json_data) {\n    if (typeof json_data === 'object') {\n      if ('metadata' in json_data) {\n        if ('metabook' in json_data.metadata) {\n          if ('links' in json_data.metadata.metabook) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  },\n  is_native: function(file_json) {\n    if ('metadata' in file_json) {\n      if (file_json.metadata.format === \"native\") {\n        return true;\n      }\n    }\n    return false;\n  },\n  get_cells: function(metabook_model) {\n    return metabook_model.get('cells').models;\n  },\n  get_ids: function(cells) {\n    var cell, i, ids, len;\n    ids = [];\n    for (i = 0, len = cells.length; i < len; i++) {\n      cell = cells[i];\n      ids.push(cell.id);\n    }\n    return ids;\n  },\n  get_links: function(metabook_model) {\n    return metabook_model.get('links').models;\n  }\n};\n\n//# sourceMappingURL=data.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./data.js\n ** module id = 4\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\n(function(global, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof module !== 'undefined' && module.exports) {\n    module.exports = factory();\n  } else {\n    global.ReconnectingWebSocket = factory();\n  }\n})(this, function() {\n  var ReconnectingWebSocket;\n  ReconnectingWebSocket = function(url, protocols, options) {\n    var eventTarget, forcedClose, generateEvent, key, self, settings, timedOut, ws;\n    settings = {\n      debug: false,\n      automaticOpen: true,\n      reconnectInterval: 1000,\n      maxReconnectInterval: 30000,\n      reconnectDecay: 1.5,\n      timeoutInterval: 2000,\n      maxReconnectAttempts: null,\n      binaryType: 'blob'\n    };\n\n    /**\n     * This function generates an event that is compatible with standard\n     * compliant browsers and IE9 - IE11\n     *\n     * This will prevent the error:\n     * Object doesn't support this action\n     *\n     * http://stackoverflow.com/questions/19345392/why-arent-my-parameters-getting-passed-through-to-a-dispatched-event/19345563#19345563\n     * @param s String The name that the event should use\n     * @param args Object an optional object that the event will use\n     */\n    generateEvent = function(s, args) {\n      var evt;\n      evt = document.createEvent('CustomEvent');\n      evt.initCustomEvent(s, false, false, args);\n      return evt;\n    };\n    if (!options) {\n      options = {};\n    }\n    for (key in settings) {\n      if (typeof options[key] !== 'undefined') {\n        this[key] = options[key];\n      } else {\n        this[key] = settings[key];\n      }\n    }\n\n    /** The URL as resolved by the constructor. This is always an absolute URL. Read only. */\n    this.url = url;\n\n    /** The number of attempted reconnects since starting, or the last successful connection. Read only. */\n    this.reconnectAttempts = 0;\n\n    /**\n     * The current state of the connection.\n     * Can be one of: WebSocket.CONNECTING, WebSocket.OPEN, WebSocket.CLOSING, WebSocket.CLOSED\n     * Read only.\n     */\n    this.readyState = WebSocket.CONNECTING;\n\n    /**\n     * A string indicating the name of the sub-protocol the server selected; this will be one of\n     * the strings specified in the protocols parameter when creating the WebSocket object.\n     * Read only.\n     */\n    this.protocol = null;\n    self = this;\n    ws = void 0;\n    forcedClose = false;\n    timedOut = false;\n    eventTarget = document.createElement('div');\n    eventTarget.addEventListener('open', function(event) {\n      self.onopen(event);\n    });\n    eventTarget.addEventListener('close', function(event) {\n      self.onclose(event);\n    });\n    eventTarget.addEventListener('connecting', function(event) {\n      self.onconnecting(event);\n    });\n    eventTarget.addEventListener('message', function(event) {\n      self.onmessage(event);\n    });\n    eventTarget.addEventListener('error', function(event) {\n      self.onerror(event);\n    });\n    this.addEventListener = eventTarget.addEventListener.bind(eventTarget);\n    this.removeEventListener = eventTarget.removeEventListener.bind(eventTarget);\n    this.dispatchEvent = eventTarget.dispatchEvent.bind(eventTarget);\n    this.open = function(reconnectAttempt) {\n      var localWs, timeout;\n      ws = new WebSocket(self.url, protocols || []);\n      ws.binaryType = this.binaryType;\n      if (reconnectAttempt) {\n        if (this.maxReconnectAttempts && this.reconnectAttempts > this.maxReconnectAttempts) {\n          return;\n        }\n      } else {\n        eventTarget.dispatchEvent(generateEvent('connecting'));\n        this.reconnectAttempts = 0;\n      }\n      Backbone.trigger(\"session:connecting\", this);\n      console.log(\"<session:connecting>\");\n      if (self.debug || ReconnectingWebSocket.debugAll) {\n        console.debug('ReconnectingWebSocket', 'attempt-connect', self.url);\n      }\n      localWs = ws;\n      timeout = setTimeout((function() {\n        if (self.debug || ReconnectingWebSocket.debugAll) {\n          console.debug('ReconnectingWebSocket', 'connection-timeout', self.url);\n        }\n        timedOut = true;\n        localWs.close();\n        timedOut = false;\n      }), self.timeoutInterval);\n      ws.onopen = function(event) {\n        var e;\n        clearTimeout(timeout);\n        if (self.debug || ReconnectingWebSocket.debugAll) {\n          console.debug('ReconnectingWebSocket', 'onopen', self.url);\n        }\n        self.protocol = ws.protocol;\n        self.readyState = WebSocket.OPEN;\n        self.reconnectAttempts = 0;\n        e = generateEvent('open');\n        e.isReconnect = reconnectAttempt;\n        reconnectAttempt = false;\n        eventTarget.dispatchEvent(e);\n      };\n      ws.onclose = function(event) {\n        var timeout;\n        var e;\n        clearTimeout(timeout);\n        ws = null;\n        if (forcedClose) {\n          self.readyState = WebSocket.CLOSED;\n          eventTarget.dispatchEvent(generateEvent('close'));\n        } else {\n          self.readyState = WebSocket.CONNECTING;\n          e = generateEvent('connecting');\n          e.code = event.code;\n          e.reason = event.reason;\n          e.wasClean = event.wasClean;\n          eventTarget.dispatchEvent(e);\n          if (!reconnectAttempt && !timedOut) {\n            if (self.debug || ReconnectingWebSocket.debugAll) {\n              console.debug('ReconnectingWebSocket', 'onclose', self.url);\n            }\n            eventTarget.dispatchEvent(generateEvent('close'));\n          }\n          timeout = self.reconnectInterval * Math.pow(self.reconnectDecay, self.reconnectAttempts);\n          console.log(\"<session:waiting> \" + (timeout > self.maxReconnectInterval ? self.maxReconnectInterval : timeout));\n          Backbone.trigger(\"session:waiting\", this, timeout > self.maxReconnectInterval ? self.maxReconnectInterval : timeout);\n          setTimeout((function() {\n            self.reconnectAttempts++;\n            self.open(true);\n          }), timeout > self.maxReconnectInterval ? self.maxReconnectInterval : timeout);\n        }\n      };\n      ws.onmessage = function(event) {\n        var e;\n        if (self.debug || ReconnectingWebSocket.debugAll) {\n          console.debug('ReconnectingWebSocket', 'onmessage', self.url, event.data);\n        }\n        e = generateEvent('message');\n        e.data = event.data;\n        eventTarget.dispatchEvent(e);\n      };\n      ws.onerror = function(event) {\n        if (self.debug || ReconnectingWebSocket.debugAll) {\n          console.debug('ReconnectingWebSocket', 'onerror', self.url, event);\n        }\n        eventTarget.dispatchEvent(generateEvent('error'));\n        Backbone.trigger(\"connection:error\", this);\n        console.log(\"<session:error>\");\n      };\n    };\n    if (this.automaticOpen === true) {\n      this.open(false);\n    }\n\n    /**\n     * Transmits data to the server over the WebSocket connection.\n     *\n     * @param data a text string, ArrayBuffer or Blob to send to the server.\n     */\n    this.send = function(data) {\n      if (ws) {\n        if (self.debug || ReconnectingWebSocket.debugAll) {\n          console.debug('ReconnectingWebSocket', 'send', self.url, data);\n        }\n        return ws.send(data);\n      } else {\n        throw 'INVALID_STATE_ERR : Pausing to reconnect websocket';\n      }\n    };\n\n    /**\n     * Closes the WebSocket connection or connection attempt, if any.\n     * If the connection is already CLOSED, this method does nothing.\n     */\n    this.close = function(code, reason) {\n      if (typeof code === 'undefined') {\n        code = 1000;\n      }\n      forcedClose = true;\n      if (ws) {\n        ws.close(code, reason);\n      }\n    };\n\n    /**\n     * Additional public API method to refresh the connection if still open (close, re-open).\n     * For example, if the app suspects bad data / missed heart beats, it can try to refresh.\n     */\n    this.refresh = function() {\n      if (ws) {\n        ws.close();\n      }\n    };\n  };\n  if (!('WebSocket' in window)) {\n    return;\n  }\n\n  /**\n   * An event listener to be called when the WebSocket connection's readyState changes to OPEN;\n   * this indicates that the connection is ready to send and receive data.\n   */\n  ReconnectingWebSocket.prototype.onopen = function(event) {};\n\n  /** An event listener to be called when the WebSocket connection's readyState changes to CLOSED. */\n  ReconnectingWebSocket.prototype.onclose = function(event) {};\n\n  /** An event listener to be called when a connection begins being attempted. */\n  ReconnectingWebSocket.prototype.onconnecting = function(event) {};\n\n  /** An event listener to be called when a message is received from the server. */\n  ReconnectingWebSocket.prototype.onmessage = function(event) {};\n\n  /** An event listener to be called when an error occurs. */\n  ReconnectingWebSocket.prototype.onerror = function(event) {};\n\n  /**\n   * Whether all instances of ReconnectingWebSocket should log debug messages.\n   * Setting this to true is the equivalent of setting all instances of ReconnectingWebSocket.debug to true.\n   */\n  ReconnectingWebSocket.debugAll = false;\n  ReconnectingWebSocket.CONNECTING = WebSocket.CONNECTING;\n  ReconnectingWebSocket.OPEN = WebSocket.OPEN;\n  ReconnectingWebSocket.CLOSING = WebSocket.CLOSING;\n  ReconnectingWebSocket.CLOSED = WebSocket.CLOSED;\n  return ReconnectingWebSocket;\n});\n\n//# sourceMappingURL=websocket.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./websocket.js\n ** module id = 5\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\nvar SessionDisconnectedMessage,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nSessionDisconnectedMessage = (function(superClass) {\n  extend(SessionDisconnectedMessage, superClass);\n\n  function SessionDisconnectedMessage() {\n    this.render = bind(this.render, this);\n    this.hide = bind(this.hide, this);\n    this.show = bind(this.show, this);\n    return SessionDisconnectedMessage.__super__.constructor.apply(this, arguments);\n  }\n\n  SessionDisconnectedMessage.prototype.initialize = function() {\n    var templates;\n    SessionDisconnectedMessage.__super__.initialize.apply(this, arguments);\n    templates = require('./templates');\n    this.template = templates.Messages.SessionDisconnected;\n    return this.render();\n  };\n\n  SessionDisconnectedMessage.prototype.show = function() {\n    return this.$el.find(\".message\").removeClass(\"hidden\");\n  };\n\n  SessionDisconnectedMessage.prototype.hide = function() {\n    return this.$el.find(\".message\").addClass(\"hidden\");\n  };\n\n  SessionDisconnectedMessage.prototype.render = function() {\n    return this.$el.html(this.template);\n  };\n\n  return SessionDisconnectedMessage;\n\n})(Backbone.View);\n\nmodule.exports = {\n  SessionDisconnectedMessage: SessionDisconnectedMessage\n};\n\n//# sourceMappingURL=ui_messages.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./ui_messages.js\n ** module id = 6\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.10.0\nmodule.exports = {\n  Messages: {\n    SessionDisconnected: '<div class=\"ui yellow message hidden\" style=\"position:fixed; top:70px; left: 50%; transform: translateX(-50%);\"> <div class=\"header\"> Kernel disconnected </div> <p>Kernel is disconnected, trying to connect in XX seconds...</p></div>'\n  }\n};\n\n//# sourceMappingURL=templates.js.map\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./templates.js\n ** module id = 7\n ** module chunks = 0\n **/"],"sourceRoot":""}