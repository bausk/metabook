// Generated by CoffeeScript 1.10.0
var error_graph, init_graph;

$(document).ready(function() {
  var global_gui, imports, message, notebook, session, uivent;
  imports = {
    ui: require("./ui"),
    connect: require("./connect"),
    data: require("./data"),
    messages: require("./ui_messages"),
    settings: require("./settings")
  };
  _.extend(imports, require("./objects"));
  message = new imports.messages.SessionDisconnectedMessage({
    el: imports.settings.id.globalmessages
  });
  uivent = new imports.ui.Vent();
  uivent.register({
    'ui': imports.ui
  });
  global_gui = new imports.ui.GlobalGUI();
  session = new imports.connect.Session(config.sessions_endpoint);
  notebook = new imports.models.MetabookModel({});
  return notebook.connect(session.connect_file(config.file.path));
});

init_graph = function(json_graph) {
  var menuview, notebook, paper;
  notebook = new metabook.models.MetabookModel({}, {
    json_graph: json_graph
  });
  paper = init_jointjs(notebook);
  $("#bottom_sidebar").sidebar({
    context: $('#id2')
  });
  $("#bottom_sidebar").sidebar('setting', 'transition', 'overlay');
  $("#bottom_sidebar").sidebar('setting', 'dimPage', false);
  $("#bottom_sidebar").sidebar('attach events', '#uiMenuToggle');
  $("#bottom_sidebar").sidebar('setting', 'closable', false);
  uivent.register({
    'session': notebook.session,
    'model': notebook,
    'graph': paper.model
  });
  jointjs_attach_events(paper, paper.model);
  return menuview = new metabook.views.MenuView({
    el: $("#metabook_top_menu"),
    model: notebook
  });
};

error_graph = function(e) {
  $("#id2").dimmer('hide');
  return alert("Connection error. Check if your backend is running.");
};

//# sourceMappingURL=init.js.map
